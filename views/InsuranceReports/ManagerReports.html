<style>
    .CursorLeft {
            cursor: pointer !important;
        }

        .ReplacedClass {
            border: 2px solid #6bbae0 !important;
            padding: 12px 15px 15px 15px !important;
            border-radius: 4px !important;
            margin-bottom: 10px !important;
        }

         #btnAddCustomItem:hover {
            color: ghostwhite;
        }

        .mandatory {
            color: red;
        }

        .NoDecoration {
            text-decoration: none !important;
            color: black;
        }

        .angucomplete-dropdown {
            bottom: 100% !important;
        }

        .table tfoot tr th
        {
            border: none !important;
            font-size: 14px !important;
        }

        .panel-border
        {
            border-color:#ddd;
            border-radius: 0 !important;
        }

        @media (min-device-width:768px) {
            .width14 {
                width: 16% !important;
            }

            .width16 {
                width: 17.6%;
                height: 4px;
            }

            .StatusNumber {
                margin-left: 2% !important;
            }

            .StatusHorizontalLine {
                margin-left: 9% !important;
            }
        }

        @media (max-device-width:768px) {
            .width14 {
                width: 14% !important;
            }

            .width16 {
                width: 15%;
                height: 4px;
            }

            .StatusNumber {
                margin-left: 13% !important;
            }

            .StatusHorizontalLine {
                margin-left: 18% !important;
            }
        }

         .btn-default {
            color: #333;
            background-color: #c2cad8;
            border-color: #adadad;
        }

        .btn-default:focus,
        .btn-default.active,
        .btn-default:hover,
        .focus,
        .active {
            color: rgb(248, 244, 244) !important;
            background-color: #4b4848 !important;
            border-color: #3a3737 !important;
        }

        .btn-fonts
        {
            font-size: 12px!important;
            font-weight: 600 !important;
        }

        @media only screen and (min-width: 769px)
        {
        .sc-incoming button
        {
            width: 100px !important;
            padding: 2px 0px !important;
            font-size: 12px!important;
        }

        .sc-incoming button.quarter-btn
        {
            width: 140px !important;
        }

        }

        @media only screen and (max-width: 767px)
        {
            .chart-content-body{
                padding : 10px 1px  !important;
            }

            .chart-panel-body
            {
                padding: 10px 1px !important;
            }

            .report-body
            {
                margin-top: 15px !important;
                padding:1px !important;
            }

             .line-chart-box
            {
             max-height: 790px;
            }
    }

        /* .overflow-container
        {
            width: 350px;
            height: 230px;
            overflow: auto;
        } */

        .performance-indicators
           {
               margin-top: -8px !important;
           }

            .input-box {
            outline: none !important;
            box-shadow: none !important;
            display: block;
            width: 100%;
            height: 25px;
            padding: 6px 12px;
            padding-bottom: 8px;
            font-size: 13px;
            line-height: 1.42857;
            color: #555555;
            background-color: #fff;
            background-image: none;
            border: 1px solid #c2cad8;
            border-radius: 4px;
            -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
            box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
            -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;
            -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;
            transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;
        }

         .input-group-addon {
            padding: 3px 9px !important;
        }

        .form-control
        {
          border-radius: 4px !important;
        }

         .control-label {
            text-align: right !important;
            margin-bottom: 0 !important;
            padding-top: 2px !important;
        }

        .active-link
        {
         color: #23527c;
         text-decoration: underline;
        }

        /* Start - Button dropdown styles */
        .dropdown {
                position: relative;
                display: inline-block;
            }
            .dropdown-content {
                display: none;
                position: absolute;
                right: 0;
                /*background-color: #f9f9f9;*/
                background-color: #FFFFFF;
                min-width: 90px;
                box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
                z-index: 1;
                /*border-radius: 5px;*/
            }
            .dropdown-content a {
                color: black;
                background-color: #FFFFFF;
                padding: 0px;
                text-decoration: none;
                display: block;
                border: none;
                width: 87px;
            }
            .dropdown-content a:hover {
                /*background-color: #edecec*/
                background: #cce7f3 !important;
                color: #339FFF!important;
            }
            .dropdown:hover .dropdown-content {
                display: block;
            }
            .dropdown:disabled .dropdown-content,
            .dropdown[disabled] .dropdown-content
            {
                display: none !important;
            }
            /* End - Button dropdown styles */

            li.active {
                background-color: #33aae5!important;
                color: #7fa5c6 !important;
            }

    </style>
<script type="text/javascript">
    $(function () {
        iOSHandler();
        $(window).on("orientationchange", function (event) {
            iOSHandler();
        });
    });
    function iOSHandler() {
        var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        var width = screen.width;

        if (iOS) {

            var orientation;
            if (window.orientation == undefined) {
                orientation = window.screen.orientation.angle;
            }
            else {
                orientation = window.orientation;
            }

            if (orientation != 0) {
                if (screen.width < screen.height) {
                    width = screen.height;
                }
            }
            //iPhone4-Landscape
            if (width > 475 && width < 485) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }

            //iPhone5-Landscape
            else if (width > 562 && width < 572) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }
            //iPhone4,5-Portrait
            else if (width > 315 && width < 325) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }

            //iPhone6-Landscape
            else if (width > 660 && width < 670) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }
            //iPhone6-Portrait
            else if (width > 370 && width < 380) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }

            //iPhone6+-Landscape
            else if (width > 730 && width < 740) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }
            //iPhone6+-Portrait
            else if (width > 410 && width < 420) {
                $(".comparablesDivDB").css("height", "auto");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");

            }

            //ipad
            else if (width > 1020 && width < 1025) {
                $(".comparablesDivDB").css("height", "958px");
                $(".googleComparableBodyHeight").css("height", "729px");
                $(".googleSerachResultDiv").css("height", "632px");
                $(".noteDiv").css("height", "215px");
                $(".addedComp").css("height", "215px");
                $(".addedComp").css("width", "100%");
                $(".addedComp").css("overflow", "scroll");
                $(".addedComp").css("-webkit-overflow-scrolling", "touch");


            }

            //else if (width > 760 && width < 769) {

            //    $(".googleComparableBodyHeight").css("height", "680px");

            //}
            else if (width > 1360 && width < 1367) {
                $(".googleComparableBodyHeight").css("height", "540px");
                $(".comparablesDivDB").css("height", "853px");

            }
        }
    }

    $(document).ready(function () {
        $selectElement = $("#select1").select2({});
        $selectElement = $("#select2").select2({});
    });

    $(function () {
        $(':input[type=number]').on('mousewheel', function (e) { $(this).blur(); });
    });

    $(".readonly").on('keydown paste', function (e) {
        e.preventDefault();
    });

    //btn-groups
    // Company-Performance
    $(".btn-group-company-performance > .btn").click(function () {
        $(".btn-group-company-performance > .btn").removeClass("active");
        $(this).addClass("active");
    });

    $("a").click(function () {
        $("a.active-link").removeClass("active-link");
        $(this).addClass("active-link");
    });
</script>

<div class="container-fluid padding1px">

    <div class="col-md-12 home-breadcrumb">
        <ul class="page-breadcrumb breadcrumb sbold">
            <li>
                <a ng-click="gotoDashboard()">{{"Dashboard"|translate}}</a>
                <i class="fa fa-circle"></i>
            </li>
            <li>
                <span>{{"HeaderText.Reports"|translate}}</span>
            </li>
        </ul>
    </div>

    <div class="panel-body report-body">
        <div class="form-group">

            <!--Start Company performance Information-->
            <div class="portlet light padding1px" style="margin-bottom: 0px !important;">
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12 colsm-12">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding1px container">
                                <div class="panel panel-default" style="border-color: #3598dc; border-radius: 0 !important;margin-top: 0px;margin-bottom: 0px;">
                                    <div class="panel-body">

                                        <div class="col-md-12 col-sm-12" style="padding: 0px 10px;">
                                            <div class="col-md-12 col-sm-12 SubHeadingDiv margin-bottom-10">
                                                <span class="caption-subject" style="font-size: 14px; font-weight: 700;">
                                                    {{"LabelText.CompanyPerformance"|translate}}</span>
                                                <div class="col-lg-3 col-md-3 col-sm-6 margin-bottom-5 margin-top-5 pull-right dropdown"
                                                    style="display:initial;width:95px;padding:0px;margin-top: -5px;">
                                                    <button class="btn btn-default sbold btnMargin" type="button"
                                                        data-toggle="dropdown" ><span class="glyphicon glyphicon-download-alt"></span>&nbsp;{{"Export"|translate}}
                                                        <span class="caret"></span>
                                                    </button>
                                                    <div class="dropdown-content" style="left: 5px;padding:0px;z-index: 9;">
                                                        <a ng-click="exportCompanyPerformanceReport('PDF');" class="btn btn-default sbold btnMargin"
                                                            style="padding: 0px!important;padding-bottom: 4px!important; padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"PDF"
                                                            | translate}} <i class="fa fa-file-pdf-o" style="font-size:14px;color:red"></i></a>
                                                        <!-- <a ng-click="exportCompanyPerformanceReport('CSV');" class="btn btn-default sbold btnMargin"
                                                            style="padding: 0px !important;
                                                                padding-bottom: 4px !important;padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"CSV"
                                                            | translate}} <i class="fa fa-file-text-o" style="font-size:14px;color:blue;"></i></a> -->
                                                        <a ng-click="exportCompanyPerformanceReport('Excel');" class="btn btn-default sbold btnMargin"
                                                            style="padding: 0px !important; padding-bottom: 4px !important;padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"Excel"
                                                            | translate}} <i class="fa fa-file-excel-o" style="font-size:14px;color:green;"></i></a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 pull-left" style="margin-left: 20px;"
                                                data-toggle="buttons">
                                                <div class="btn-group btn-group-company-performance" role="group"
                                                    aria-label="...">
                                                    <button type="button" ng-click="getCompanyPerformance(1)" class="btn btn-default btn-fonts active">{{"LabelText.ThisMonth"|translate}}({{yearValues.thisMonth}}
                                                        '{{yearValues.thisSplitYear}})</button>
                                                    <button type="button" ng-click="getCompanyPerformance(2)" class="btn btn-default btn-fonts">{{"LabelText.ThisQuarter"|translate}}({{yearValues.thisQuaterFirstMonth}}
                                                        - {{yearValues.thisQuaterLastMonth}}
                                                        '{{yearValues.thisSplitYear}})</button>
                                                    <button type="button" ng-click="getCompanyPerformance(3)" class="btn btn-default btn-fonts">{{"LabelText.ThisYear"|translate}}({{yearValues.thisYear}})</button>
                                                </div>
                                            </div>
                                        </div>

                                        <br>

                                        <div class="overflow-container" style="width:100%;height:130px;">
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                                                    <div class="panel panel-default panel-border" >
                                                        <div class="panel-body border-style" style="text-align:center;">
                                                            <strong>
                                                                <h4 style="font-weight: 500;">{{TotalAppraisalsCreated}}</h4>
                                                            </strong>
                                                            <h6>{{"LabelText.TotalAppraisalsCreated"|translate}}</h6>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 hide">
                                                    <div class="panel panel-default panel-border">
                                                        <div class="panel-body border-style" style="text-align:center;">
                                                            <strong>
                                                                <h4 style="font-weight: 500;">{{AppraisalsCreatedPerDay}}</h4>
                                                            </strong>
                                                            <h6>{{"LabelText.AppraisalsCreatedPerDay"|translate}}</h6>
                                                        </div>
                                                    </div>
                                                </div> -->

                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 ">
                                                    <div class="panel panel-default panel-border">
                                                        <div class="panel-body border-style" style="text-align:center;">
                                                            <strong>
                                                                <h4 style="font-weight: 500;">{{AvgEvaluationTime}}</h4>
                                                            </strong>
                                                            <h6>{{"LabelText.AvgEvaluationTime"|translate}}</h6>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 ">
                                                    <div class="panel panel-default panel-border">
                                                        <div class="panel-body border-style" style="text-align:center;">
                                                            <strong>
                                                                <h4 style="font-weight: 500;">{{AppraisalsEvaluatedPerDay}}</h4>
                                                            </strong>
                                                            <h6>{{"LabelText.AppraisalsEvaluatedPerDay"|translate}}</h6>
                                                        </div>
                                                    </div>
                                                </div> -->

                                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 ">
                                                    <div class="panel panel-default panel-border">
                                                        <div class="panel-body border-style" style="text-align:center;">
                                                            <strong>
                                                                <h4 style="font-weight: 500;">{{AppraisalsSentToArtigem}}</h4>
                                                            </strong>
                                                            <h6>{{"LabelText.AppraisalsSentForArtigem"|translate}}</h6>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--END-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--End Company performance Information-->

            <!-- Appraisals Report starts here -->
            <div class="portlet light padding1px" style="margin-bottom: 0px !important;">
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12 colsm-12">
                            <div class="portlet-title" style="border-bottom: 1px solid #666; margin-bottom: 5px;">
                                <div class="caption font-gray-sharp ">
                                    <span class="caption-subject ng-binding" style="font-size: 18px;color: #666;">{{"LabelText.AppraisalsReport"|translate}}</span>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding1px container">
                                <div class="panel panel-default" style="border-color: #3598dc; border-radius: 0 !important;margin-top: 0px;margin-bottom: 0px;">
                                    <div class="panel-body">
                                        <div class="caption font-gray-sharp ">
                                            <span class="caption-subject ng-binding" style="font-size: 15px;color: black;font-weight: bold;margin-left: 10px;">{{"LabelText.Filters"|translate}}</span>
                                        </div>
                                        <br />
                                        <form class="form-horizontal" name="policyReportFilters">
                                            <!-- Policy effective date-->
                                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12  form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                    <label class="control-label ">
                                                        {{"LabelText.PolicyEffectiveDate"|translate}}
                                                    </label>
                                                </div>


                                                <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                                                    <div class="col-lg-3 col-md-5 col-sm-6 p_left_zero" id="calFrom">
                                                        <div class="input-icon left">
                                                            <i class="icon-calendar"></i>
                                                            <input class="form-control datepicker fromDateCls" data-date-container='#calFrom'
                                                                ng-model="reportFilter.fromDate" data-date="{{reportFilter.fromDate}}" data-provide="datepicker" size="16" type="text" placeholder="{{'From'|translate}} "
                                                                name="fromDate" id="fromDate" autocomplete="fakeFromDate" readonly />                                        
                                                        </div>
                                                        <!-- <div class="input-icon left">
                                                            <i class="icon-calendar"></i>
                                                            <input class="form-control datepicker" data-date-container='#calFrom' data-date-end-date="+0d"
                                                                ng-model="reportFilter.fromDate" data-provide="datepicker" size="16" type="text" placeholder="{{'From'|translate}} "
                                                                name="fromDate" id="fromDate" ng-change="changeDate()" autocomplete="fakeFromDate" />                                        
                                                        </div> -->
                                                    </div>
                                                    <div class="col-sm-1 bold">To</div>
                                                    <div class="col-lg-3 col-md-5 col-sm-6 p_left_zero" id="cal_to">
                                                        <div class="input-icon left">
                                                            <i class="icon-calendar"></i>
                                                            <input class="form-control datepicker toDateCls" data-date-container='#cal_to' data-date-start-date="{{reportFilter.fromDate}}"
                                                                ng-model="reportFilter.toDate" data-date="{{reportFilter.toDate}}" data-provide="datepicker" size="16" type="text" placeholder="{{'To'|translate}} "
                                                                name="toDate" id="toDate" autocomplete="fakeToDate" readonly />                                        
                                                        </div>
                                                        <!-- <div class="input-icon left">
                                                            <i class="icon-calendar"></i>
                                                            <input class="form-control datepicker" data-date-container='#cal_to' data-date-end-date="+0d"
                                                                ng-model="reportFilter.toDate" data-provide="datepicker" size="16" type="text" placeholder="{{'To'|translate}} "
                                                                name="toDate" id="toDate" ng-change="changeDate()" autocomplete="fakeToDate" />                                        
                                                        </div> -->
                                                    </div>
                                                </div>                                              
                                            </div>

                                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12  form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 ">
                                                    <label class="control-label ">
                                                        {{"LabelText.AppraisalStatus"|translate}}
                                                    </label>
                                                </div>
                                                <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                                                    <select class="form-control" ng-model="reportFilter.appraisalStatus"
                                                        data-placeholder="State" ng-options="option.id as option.status for option in appraisalStatus">
                                                        <option></option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12  form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 ">
                                                    <label class="control-label ">
                                                        {{"Policy State"|translate}}
                                                    </label>
                                                </div>
                                                <div class="col-md-2 col-sm-6 col-xs-12">
                                                    <select class="form-control" ng-model="reportFilter.state"
                                                        data-placeholder="State" ng-change="getAgentsByState(reportFilter.state)" ng-options="option.id as option.state for option in StateList">
                                                        <option></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <!-- <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12  form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 ">
                                                    <label class="control-label ">
                                                        Insurance Agent
                                                    </label>
                                                </div>
                                                <div class="col-md-2 col-sm-6 col-xs-12">
                                                    <select class="form-control" ng-model="reportFilter.agent"
                                                        data-placeholder="agent" ng-options="option.agentId as option.fullName for option in agentsList">
                                                        <option></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div ng-message="required" style="margin-left: 17.5%;"
                                            ng-show="reportFilter.state==null">
                                            <span
                                                class="text-danger">{{"Please Select State for Insurance agents"|translate}}</span>
                                           </div> -->

                                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 form-group hide">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                    <label class="control-label ">
                                                        {{"LabelText.ViewOptions"|translate}}
                                                    </label>
                                                </div>
                                                <div class="col-md-4 col-sm-8">
                                                    <!-- <select class="form-control select2me" name="associates" multiple required ng-model="CommonObj.Role" placeholder='{{"ControlText.Office"|translate}}'
                                                                id="select2insidemodal" ng-options="item.employeeNumber as item.name for item in RoleList "></select> -->
                                                    <a class="active-link" ng-click="SearchByAppraisal()">{{"LabelText.ViewByAppraisal"|translate}}</a>&nbsp;&nbsp;
                                                    <a ng-click="SearchByPolicy()">{{"LabelText.ViewByPolicy"|translate}}</a>
                                                </div>
                                            </div>

                                            <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12  form-group">
                                                <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                                                </div>
                                                <div class="col-lg-1 col-md-2 col-sm-6 col-xs-6" style="margin-right:0px ;">
                                                    <button class="btn btn-default sbold" ng-click="filterReports()">{{"LabelText.Submit"|translate}}</button>
                                                </div>
                                                <div class="col-lg-1 col-md-2 col-sm-6 col-xs-6">
                                                    <button class="btn btn-default sbold" ng-click="resetSearchValues()">Reset</button>
                                                </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- policy report ends here -->

            <!---Branches/Office-->
            <div class="portlet light padding1px">
                <div class="portlet-body">
                    <div class="row">
                        <div class="col-md-12 colsm-12">

                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 options_Background padding1px">
                                <div class="col-lg-3 col-md-3 col-sm-6 margin-bottom-5 margin-top-5 pull-left dropdown"
                                    style="display:initial;width:95px;padding:0px;margin-left:10px;" ng-disabled="isDisable">
                                    <button class="btn btn-default sbold btnMargin" type="button" data-toggle="dropdown"><span
                                            class="glyphicon glyphicon-download-alt"></span>&nbsp;{{"Export"|translate}}
                                        <span class="caret"></span>
                                    </button>
                                    <div class="dropdown-content" style="left: 5px;padding:0px;z-index: 9;">
                                        <a ng-click="exportAppraisalReport('PDF');" class="btn btn-default sbold btnMargin"
                                            style="padding: 0px!important;padding-bottom: 4px!important; padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"PDF"
                                            | translate}} <i class="fa fa-file-pdf-o" style="font-size:14px;color:red"></i></a>
                                        <!-- <a ng-click="exportAppraisalReport('CSV');" class="btn btn-default sbold btnMargin"
                                            style="padding: 0px !important;
                                                padding-bottom: 4px !important;padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"CSV"
                                            | translate}} <i class="fa fa-file-text-o" style="font-size:14px;color:blue;"></i></a> -->
                                        <a ng-click="exportAppraisalReport('Excel');" class="btn btn-default sbold btnMargin"
                                            style="padding: 0px !important; padding-bottom: 4px !important;padding-top: 2px !important;padding-left: 12px !important;text-align: left">{{"Excel"
                                            | translate}} <i class="fa fa-file-excel-o" style="font-size:14px;color:green;"></i></a>
                                     </div>
                                </div>

                                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 margin-bottom-5  margin-top-5  pull-right">
                                    <div class="input-icon left">
                                        <i class="icon-magnifier"></i>
                                        <input type="text" ng-model="reportFilter.searchQuery" class="form-control form-control-solid input-circle input-block-level "
                                            placeholder="{{'Table.placeholder' | translate}}" ng-keyup="reportFilter.searchQuery.length > 0 ? ($event.keyCode == 13 && searchAppraisalReportBykey(reportFilter.searchQuery)) : searchAppraisalReportBykey('')">
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12 table-responsive padding1px" style="background-color: white;">
                                <table class="table  table-striped table-bordered table-hover table-checkable order-column"
                                    width="100%">
                                    <thead>
                                        <tr>

                                            <th ng-click="sort('appraisal_number')">
                                                {{"Table.Appraisal#"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='appraisal_number'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>
                                            <th ng-click="sort('item_type')">
                                                {{"Table.ItemCategory"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='item_type'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>
                                            <th ng-click="sort('policy_number')">
                                                {{"Table.Policy#"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='policy_number'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>
                                            <th ng-click="sort('insurance_agent')">
                                                {{"Table.InsuranceAgent"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='insurance_agent'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>

                                            <th ng-click="sort('agency_code')">
                                                {{"Table.AgencyCode"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='agency_code'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>
                                            <th ng-click="sort('agency_code')">
                                               State
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='agency_code'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>
                                            <th ng-click="sort('appraisal_date')">
                                                Old Appraisal Date
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='appraisal_date'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>
                                            <th ng-click="sort('agency_code')">
                                                Old Appraisal Value
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='agency_code'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>
                                            <th ng-click="sort('new_appraisal_value')">
                                                New Appraisal Value
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='new_appraisal_value'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>
                                            <th ng-click="sort('change_in_coverage')">
                                                Change in Coverage
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='change_in_coverage'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>

                                            </th>

                                            <th ng-click="sort('new_insurance_premium_cost')">
                                                {{"Table.AnnualPremium"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='new_insurance_premium_cost'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>

                                            <th ng-click="sort('status')">
                                                {{"Table.Status"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='status'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>

                                            <th ng-click="sort('created_date')">
                                                {{"Table.CreatedDate"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='created_date'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>

                                            <th ng-click="sort('approved_date')">
                                                {{"Table.ApprovedDate"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='approved_date'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>

                                            <th ng-click="sort('evaluation_time')">
                                                {{"Table.EvaluationTime"|translate}}
                                                <span class="glyphicon sort-icon" ng-show="sortKey==='evaluation_time'"
                                                    ng-class="{'glyphicon-chevron-up pull-right':!reverse,'glyphicon-chevron-down pull-right':reverse}"></span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-click="openAppraisalDetailsPage(item)" dir-paginate="item in appraisals | itemsPerPage:pageSize track by $index"
                                            pagination-id="appraisalsPage" total-items="totalItems" current-page="currentPage" style="cursor: pointer;">
                                            <td>{{item.appraisalNumber}}</td>
                                            <td>{{item.itemCategory.atttibuteValue}}</td>
                                            <td>{{item.policyNumber}}</td>
                                            <td>{{item.agentName}}</td>
                                            <td>{{item.agentDetails.agencyCode}}</td>
                                            <td>{{item.policyholderDetails.state.stateName}}</td>
                                            <td class="text-right">{{item.appraisalEffectiveDate | formatDate}}</td>
                                            <td class="text-right">{{item.appraisalOldValue | USCurrencyFormat}}</td>
                                            <td class="text-right">{{item.sc_insuranceReplacementValue | USCurrencyFormat}}</td>
                                            <td class="text-right" ng-if='item.isNegativeValue' ng-style="{'color': 'rgb(214, 20, 20)'}">(-)&nbsp;{{item.changeInCoverage
                                                | USCurrencyFormat}}</td>
                                            <td class="text-right" ng-if='!item.isNegativeValue' ng-style="{'color': 'rgb(8, 117, 8)'}">(+)&nbsp;{{item.changeInCoverage
                                                |
                                                USCurrencyFormat}}</td>
                                            <td class="text-right">{{item.approvalDate != null ? item.newInsurancePremiumCost : 0 | USCurrencyFormat}}</td>
                                            <td>{{item.status.status | titleCase}}</td>
                                            <td>{{item.createdDate | formatDate}}</td>
                                            <td>{{item.approvedDetails.reviewedDate | formatDate}}</td>
                                            <td>{{item.approvedDetails.evaluationTime}}</td>
                                        </tr>
                                        <tr ng-if="appraisals.length===0 || appraisals===null">
                                            <td colspan="12" class="text-center text-danger" style="text-align: center;">{{"Table.NoAppraisalText"|translate}}</td>
                                        </tr>
                                    </tbody>
                                    <tfoot ng-if="appraisals.length > 0">
                                        <tr>
                                            <th colspan="6"> </th>
                                            <th>Total</th>
                                            <th class="text-right">{{totalValues.totalOldAppraisalValue | USCurrencyFormat}}</th>
                                            <th class="text-right">{{totalValues.appraisalNewValue | USCurrencyFormat}}</th>
                                            <th ng-if="totalValues.isNegativeValue" style="color: rgb(214, 20, 20)">(-)&nbsp;{{totalValues.totalChangeInCoverage
                                                | USCurrencyFormat}}</th>
                                            <th ng-if="!totalValues.isNegativeValue" style="color: rgb(8, 117, 8)">(+)&nbsp;{{totalValues.totalChangeInCoverage
                                                | USCurrencyFormat}}</th>
                                            <th>{{totalValues.totalCoverageApproved | USCurrencyFormat}}</th>
                                            <th colspan="4"></th>
                                        </tr>
                                    </tfoot>
                                </table>                                
                            </div>
                            <div class="clearfix"></div>
                                <dir-pagination-controls pagination-id="appraisalsPage" max-size="20" on-page-change="pageChanged(newPageNumber)"
                                    direction-links="true" boundary-links="true" class="pull-right">
                                </dir-pagination-controls>
                                <span ng-if="appraisals!=null && appraisals.length > 0" class="bold" style="color: #337ab7;"> Showing {{ (pageSize * (currentPage - 1))+1 }} to {{toShowingPage}} of {{totalItems}} records </span>
                        </div>
                    </div>
                </div>
            </div>
            <!---End Branches/Office-->
        </div>
    </div>
</div>
<script type="application/javascript">
    $( document ).ready(function() {
        var $injector = angular.element(document.body).injector();
        var calService = $injector.get('CalendarUtility');
        calService.calPastDateSetting("fromDateCls", "toDateCls"); // Policy Effective Dates
    });
</script>